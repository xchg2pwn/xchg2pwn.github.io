<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="noindex">

  <title>3.0 - IDA Free</title>

  <meta name="description" content="Uso básico de IDA Free">
  <meta name="author" content="xchg2pwn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="3.0 - IDA Free">
  <meta name="twitter:description" content="Uso básico de IDA Free">
  <meta name="twitter:creator" content="xchg2pwn">  
  <meta name="twitter:image" content="/exploitdevelopment/ida/image.png" />

  <meta property="og:site_name" content="xchg2pwn" />
  <meta property="og:type" content="article">
  <meta property="og:title" content="3.0 - IDA Free">
  <meta property="og:description" content="Uso básico de IDA Free">
  <meta property="og:image" content="/exploitdevelopment/ida/image.png" />

  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" type="image/png" sizes="64x64" href="/exploitdevelopment/ida/image.png">

  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css?1678854914750547280">
  <link rel="alternate" type="application/rss+xml" title="3.0 - IDA Free" href="/feed.xml">
</head>

  <body style="background-color: #282828;">
  
    <span class="mobile btn-mobile-menu">
      <i class="icon icon-list btn-mobile-menu__icon"></i>
      <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">

  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">

          <img src="/images/profile.jpg" class="user-image zoomable" alt="xchg2pwn">
          <h1 class="panel-cover__title panel-title scale-up-center">xchg2pwn</h1>

        <hr class="panel-cover__divider">
        <p class="panel-cover__description slide-top">Entusiasta del reversing y desarrollo de exploits</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">
         <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item grow"><a href="/exploitdevelopment" title="xchg2pwn" class="blog-button">Exploit Development</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
              
              <li class="navigation__item grow">
                <a href="https://github.com/xchg2pwn" title="Github" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://twitter.com/xchg2pwn" title="Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://instagram.com/xchg2pwn" title="Instagram" target="_blank">
                  <i class="icon icon-social-instagram"></i>
                  <span class="label">Instagram</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://youtube.com/@xchg2pwn" title="Youtube" target="_blank">
                  <i class="icon icon-social-youtube"></i>
                  <span class="label">Youtube</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="mailto:xchg2pwn@gmail.com" title="Correo Electronico" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>

            </ul>
          </nav>
        </div>
      </div>
    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>
    <br>
    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
    <div class="izquierda">
      <h3 class="post-title">Contenido</h3><br>
      <ul>
        <li><a href="#open">3.1 - Open</a></li>
        <li><a href="#view">3.2 - View</a></li>
        <li><a href="#parts">3.3 - Basic Parts</a></li>
        <li><a href="#basic">3.4 - Basic Usage</a></li>
        <li><a href="#dynamic">3.5 - Dynamic Usage</a></li>
      </ul>
  </div>

  <header class="post-header slide-top">
    <h4 class="post-title">Exploit Development</h2>
    <picture><img src="/exploitdevelopment/ida/image.png" style="float: right; margin-right:0px; margin-left:0px; height:60px;" class="include_image zoomable"/></picture>
    <h2 class="post-title">3.0 - IDA Free</h2><br>
  </header>

<section class="post" id="index">
    <br><p class="plain-text">Al desarrollar exploits generalmente no tenemos el codigo fuente disponible, las aplicaciones escritas en lenguajes de alto nivel como <code class="language-plaintext highlighter-rouge">Java</code> o <code class="language-plaintext highlighter-rouge">C#</code> suelen decompilarse facilmente y obtener un codigo muy parecido al original, sin embargo cuando es escrito con un lenguaje mas de bajo nivel como <code class="language-plaintext highlighter-rouge">C</code> o <code class="language-plaintext highlighter-rouge">C++</code> este proceso es mas complicado y generalmente en su lugar usamos un desensamblador</p>
    <p class="plain-text">Un desensamblador analiza el binario y lo convierte a instrucciones en ensamblador, algunos de ellos tienen la capacidad ordenar el codigo de forma en que sea mas intuitivo entender el flujo del programa, uno de los desensambladores mas conocidos es <code class="language-plaintext highlighter-rouge">IDA</code>, sin embargo hay otras alternativas como <code class="language-plaintext highlighter-rouge">Ghidra</code>, <code class="language-plaintext highlighter-rouge">Radare2</code> o <code class="language-plaintext highlighter-rouge">BinaryNinja</code></p>
    <a href="/exploitdevelopment/ida/1.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/1.png"></p></div></a>
</section>

<section class="post" id="open">
<br><h3 class="post-title">3.1 - Open</h3><br>

<p class="plain-text">Despues de instalar y abrir <code class="language-plaintext highlighter-rouge">IDA</code> se nos muestra una ventana donde podemos abrir un nuevo archivo para analizarlo o cargar un proyecto antes analizado y no iniciar de 0</p>
<a href="/exploitdevelopment/ida/2.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/2.png"></p></div></a>

<p class="plain-text">Para aprender a usarlo cargaremos el binario <code class="language-plaintext highlighter-rouge">notepad.exe</code> de nuestro Windows 10, para ejecutables de windows de 32 bits (<code class="language-plaintext highlighter-rouge">.exe</code>) y librerias (<code class="language-plaintext highlighter-rouge">.dll</code>) usaremos la opción <code class="language-plaintext highlighter-rouge">Portable executable for 80386</code> con las opciones por defecto que tiene IDA</p>
<a href="/exploitdevelopment/ida/3.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/3.png"></p></div></a>

<p class="plain-text">Al cargar el binario <code class="language-plaintext highlighter-rouge">notepad.exe</code> este empezará a analizarlo, este proceso suele tardar incluso hasta un par de minutos dependiendo del peso del archivo, cuando <code class="language-plaintext highlighter-rouge">IDA</code> termine de analizarlo nos mostrará una ventana como la siguiente</p>
<a href="/exploitdevelopment/ida/1.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/1.png"></p></div></a>

<p class="plain-text">Cuando terminamos de trabajar y cerramos el archivo tenemos la opción de <code class="language-plaintext highlighter-rouge">guardar</code> el proyecto para renaudarlo mas tarde o simplemente cerrarlo sin guardar nada</p>
<a href="/exploitdevelopment/ida/4.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/4.png"></p></div></a>

</section>

<section class="post" id="view">
<br><h3 class="post-title">3.2 - View</h3><br>

<p class="plain-text">La ventana que mas usaremos será la del desensamblado, en esta podemos organizar el codigo de 3 diferentes formas de acuerdo lo que necesitemos:</p>
<p class="plain-text">• Graph View: La vista grafica separa el codigo en funciones ordenando el codigo de la funcion en <code class="language-plaintext highlighter-rouge">bloques</code>, esta vista es bastante intuitiva ya que se puede seguir el <code class="language-plaintext highlighter-rouge">flujo</code> del programa con cada bloque que esta conectado por <code class="language-plaintext highlighter-rouge">saltos</code> o condicionales</p>
<p class="plain-text">La flecha verde indica si la condición se cumplió a través de saltos condicionales como <code class="language-plaintext highlighter-rouge">jz</code> y la flecha roja si esta no lo hizo, la flecha azul simplemente indica que solo hay un camino generalmente un <code class="language-plaintext highlighter-rouge">jmp</code> sin ningun tipo de condición</p>
<a href="/exploitdevelopment/ida/5.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/5.png"></p></div></a>

<p class="plain-text">• Text View: La vista de texto muestra todo el codigo de forma <code class="language-plaintext highlighter-rouge">lineal</code>, de esta forma tambien podemos analizar el código pero es menos intuitivo seguir el flujo, algo curioso es que podemos alternar ente estra vista y la anterior usando la tecla <code class="language-plaintext highlighter-rouge">Space</code></p>
<a href="/exploitdevelopment/ida/6.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/6.png"></p></div></a>

<p class="plain-text">• Proximity View: La vista de proximidad es un poco mas avanzada y lo que hace es que nos permite ver las <code class="language-plaintext highlighter-rouge">relaciones</code> entre funciones, variables globales y constantes, esta podemos encontrarla en <code class="language-plaintext highlighter-rouge">View > Open subviews > Proximity browser</code></p>
<a href="/exploitdevelopment/ida/26.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/26.png"></p></div></a>

</section>

<section class="post" id="parts">
<br><h3 class="post-title">3.3 - Basic Parts</h3><br>

<p class="plain-text">Aunque lo que más usaremos sera el desensamblador a la izquierda podemos encontrar 2 ventanas, la primera de ellas nos muestra todas las <code class="language-plaintext highlighter-rouge">funciones</code> existentes, cuando los simbolos no son cargados las funciones tendran como nombre <code class="language-plaintext highlighter-rouge">sub_addr</code>, al hacer doble clic sobre alguno de ellos se nos mostrará su código desensamblado</p>
<a href="/exploitdevelopment/ida/7.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/7.png"></p></div></a>

<p class="plain-text">Usando <code class="language-plaintext highlighter-rouge">Ctrl + F</code> se nos abre un cuadro de busqueda donde podemos ingresar el nombre de una <code class="language-plaintext highlighter-rouge">función</code> o su dirección para encontrarla rápidamente, ademas nos muestra datos como su sección, su dirección y la longitud que ocupa la función</p>
<a href="/exploitdevelopment/ida/8.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/8.png"></p></div></a>

<p class="plain-text">Otra ventana a la izquierda es una previsualización del gráfico, esto nos sirve para desplazarnos rápidamente en el flujo de una función grande, el <code class="language-plaintext highlighter-rouge">bloque</code> donde estamos trabajando se muestra con un cuadro con un <code class="language-plaintext highlighter-rouge">contorno</code> de puntos</p>
<a href="/exploitdevelopment/ida/9.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/9.png"></p></div></a>

<p class="plain-text">Podemos ir a bloques anteriormente analizados usando las <code class="language-plaintext highlighter-rouge">flechas</code> en la barra</p>
<a href="/exploitdevelopment/ida/10.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/10.png"></p></div></a>

</section>

<section class="post" id="basic">
<br><h3 class="post-title">3.4 - Basic Usage</h3><br>

<p class="plain-text">Algo bastante util para el analisis es la opción <code class="language-plaintext highlighter-rouge">Line prefixes</code> que nos mostrará detrás de cada función su dirección, esta la encontrarmos <code class="language-plaintext highlighter-rouge">Options > General</code></p>
<a href="/exploitdevelopment/ida/11.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/11.png"></p></div></a>
<a href="/exploitdevelopment/ida/12.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/12.png"></p></div></a>

<p class="plain-text">Otra cosa bastante util es la pequeña pestaña con <code class="language-plaintext highlighter-rouge">colores</code> presente en cada bloque</p>
<a href="/exploitdevelopment/ida/13.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/13.png"></p></div></a>

<p class="plain-text">Aqui podemos elegir un color para colorear todo el <code class="language-plaintext highlighter-rouge">bloque</code>, esto es util indentificar el flujo mas facilmente a la hora de analizarlo siguiendo un color especifico</p>
<a href="/exploitdevelopment/ida/14.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/14.png"></p></div></a>

<p class="plain-text">Se puede usar cualquier colores pero para el analisis nos puede ayudar usar solo 2, en este caso <code class="language-plaintext highlighter-rouge">verde</code> para caminos deseados y <code class="language-plaintext highlighter-rouge">rojo</code> para caminos no deseados</p>
<a href="/exploitdevelopment/ida/15.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/15.png"></p></div></a>

<p class="plain-text">Al presionar <code class="language-plaintext highlighter-rouge">:</code> sobre una instrucción nos permite ingresar un comentario en esta</p>
<a href="/exploitdevelopment/ida/16.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/16.png"></p></div></a>

<p class="plain-text">Presionando la tecla <code class="language-plaintext highlighter-rouge">n</code> sobre una variable podemos cambiarle el nombre para hacerlo las identificable, en este caso pasamos de <code class="language-plaintext highlighter-rouge">dword_addr</code> a <code class="language-plaintext highlighter-rouge">my_variable</code></p>
<a href="/exploitdevelopment/ida/17.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/17.png"></p></div></a>

<p class="plain-text">Esto funciona no solo para cambiar el nombre de variables sino también de funciones</p>
<a href="/exploitdevelopment/ida/18.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/18.png"></p></div></a>

<p class="plain-text">La pestaña <code class="language-plaintext highlighter-rouge">Imports</code> nos muestra todas las funciones importadas al binario desde una libreria externa (<code class="language-plaintext highlighter-rouge">.dll</code>), y al lado de ella información sobre ella como su dirección</p>
<a href="/exploitdevelopment/ida/19.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/19.png"></p></div></a>

<p class="plain-text">Al presionar <code class="language-plaintext highlighter-rouge">x</code> sobre el nombre de una función o una variable se abrirá una pestaña con todas las referencias a este como llamadas en este caso a la función <code class="language-plaintext highlighter-rouge">malloc()</code></p>
<a href="/exploitdevelopment/ida/20.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/20.png"></p></div></a>

</section>

<section class="post" id="dynamic">
<br><h3 class="post-title">3.5 - Dynamic Usage</h3><br>

<p class="plain-text">La forma de aprovechar <code class="language-plaintext highlighter-rouge">IDA</code> es un analisis estatico para guiarnos en uno dinamico, sin embargo para saltar entre el debugger y el desensamblador necesitamos que la dirección <code class="language-plaintext highlighter-rouge">base</code> coincida con la del proceso, gracias a protecciones como <code class="language-plaintext highlighter-rouge">ASLR</code> la dirección cambia constantemente, podemos saber la dirección actual desde <code class="language-plaintext highlighter-rouge">WinDbg</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ro">0:000> </span><span class="p">lm m notepad
Browse full module list
start    end        module name
00f60000 00f9f000   notepad    (pdb symbols)  </span>
</code></pre></div></div><br>

<p class="plain-text">Desde <code class="language-plaintext highlighter-rouge">Edit > Segments > Rebase program</code> podemos modificar la dirección base por la que nos muestra el debugger que esta siendo utilizada en tiempo de ejecucuón</p>
<a href="/exploitdevelopment/ida/21.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/21.png"></p></div></a>

<p class="plain-text">Al hacer esto sincronizamos el analisis estatico y dinamico por lo que comparten direcciones, una forma de verlo es encontrando la una función dentro de notepad como <code class="language-plaintext highlighter-rouge">StringLengthWorkerW</code>, con <code class="language-plaintext highlighter-rouge">u</code> podemos ver su codigo desensamblado</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ro">0:000> </span><span class="p">x notepad!StringLengthWorkerW
00f78fc4          notepad!StringLengthWorkerW (void)

</span><span class="ro">0:000> </span><span class="p">u notepad!StringLengthWorkerW
notepad!StringLengthWorkerW:
00f78fc4 8bff            mov     edi,edi
00f78fc6 55              push    ebp
00f78fc7 8bec            mov     ebp,esp
00f78fc9 51              push    ecx
00f78fca 56              push    esi
00f78fcb baffffff7f      mov     edx,7FFFFFFFh
00f78fd0 b8a01df600      mov     eax,offset notepad!`string' (00f61da0)  
00f78fd5 57              push    edi</span>
</code></pre></div></div><br>

<p class="plain-text">Con la tecla <code class="language-plaintext highlighter-rouge">g</code> podemos ir a esa dirección donde podemos ver que coincide y podemos seguir el flujo mas fácilmente desde <code class="language-plaintext highlighter-rouge">IDA</code> en lugar de <code class="language-plaintext highlighter-rouge">WinDbg</code></p>
<a href="/exploitdevelopment/ida/22.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/22.png"></p></div></a>

<p class="plain-text">Como ejemplo vamos a establecer un breakpoint en la función <code class="language-plaintext highlighter-rouge">CreateFileW</code> para correr el bloc de notas y detenernos cuando se crea un nuevo archivo</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ro">0:000> </span><span class="p">bp kernel32!CreateFileW  
</span><span class="ro">0:000> </span><span class="p">g</span>
</code></pre></div></div><br>

<p class="plain-text">Si intentamos averiguar donde se llamó a la función en <code class="language-plaintext highlighter-rouge">IDA</code> tendriamos que buscar las referencias a esta función, lamentablemente tenemos <code class="language-plaintext highlighter-rouge">20</code> posibilidades diferentes</p>
<a href="/exploitdevelopment/ida/23.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/23.png"></p></div></a>

<p class="plain-text">Para ello crearmos un archivo y el programa se detiene en el <code class="language-plaintext highlighter-rouge">breakpoint</code>, podemos ir hasta el siguiente <code class="language-plaintext highlighter-rouge">ret</code> y salir de la función para tener una idea de la dirección</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ro">0:000> </span><span class="p">g
Breakpoint 0 hit
eax=00000000 ebx=00000001 ecx=0085ef4c edx=77931670 esi=0675bd48 edi=00000003
eip=774ac260 esp=0085ef70 ebp=0085f810 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
KERNEL32!CreateFileW:
774ac260 ff25a0435077    jmp     dword ptr ds:0023:775043a0={KERNELBASE!CreateFileW (74c761a0)}

</span><span class="ro">0:000> </span><span class="p">pt
eax=000003e0 ebx=00000001 ecx=a07b680f edx=00000000 esi=0675bd48 edi=00000003
eip=74c76201 esp=0085ef70 ebp=0085f810 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
KERNELBASE!CreateFileW+0x61:
74c76201 c21c00          ret     1Ch

</span><span class="ro">0:000> </span><span class="p">p
eax=000003e0 ebx=00000001 ecx=a07b680f edx=00000000 esi=0675bd48 edi=00000003
eip=00f6865e esp=0085ef90 ebp=0085f810 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
notepad!SaveFile+0x8f:
00f6865e a39cf6f700      mov     dword ptr [notepad!fp (00f7f69c)],eax ds:0023:00f7f69c=00000000  </span>
</code></pre></div></div><br>

<p class="plain-text">La dirección después de salir de la función es <code class="language-plaintext highlighter-rouge">0x00f6865e</code>, si ingresamos esto a <code class="language-plaintext highlighter-rouge">IDA</code> nos lleva al bloque especifico donde se llamó a la función <code class="language-plaintext highlighter-rouge">CreateFileW</code>, algo interesante es que IDA nos muestra como comentarios los argumentos que se le pasan al llamar a una función basandose en <code class="language-plaintext highlighter-rouge">WinApis</code> para hacerlo mas legible</p>
<a href="/exploitdevelopment/ida/24.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/24.png"></p></div></a>

<p class="plain-text">Seguimos el flujo de IDA y localizamos una llamada a <code class="language-plaintext highlighter-rouge">ReadFile</code> dentro de la misma función que hizo una llamada a <code class="language-plaintext highlighter-rouge">CreateFileW</code>, en el bloque podemos ver que el contenido de <code class="language-plaintext highlighter-rouge">eax</code> en la direccion <code class="language-plaintext highlighter-rouge">0x00f650a4</code> es comentado como <code class="language-plaintext highlighter-rouge">lpBuffer</code> que de acuerdo a la <a href="https://learn.microsoft.com/es-es/windows/win32/api/fileapi/nf-fileapi-readfile">documentacion</a> es el puntero al buffer que recibe los datos leidos</p>
<a href="/exploitdevelopment/ida/25.png" target="_blank"><div><p><img src="/exploitdevelopment/ida/25.png"></p></div></a>

<p class="plain-text">Establecemos un breakpoint en la llamada a <code class="language-plaintext highlighter-rouge">ReadFile</code> y corremos el programa, al abrir un archivo se detiene en el <code class="language-plaintext highlighter-rouge">breakpoint</code> y el segundo valor en el stack o el valor actual de eax que es <code class="language-plaintext highlighter-rouge">0x0073ea08</code> deberia ser el puntero de <code class="language-plaintext highlighter-rouge">lpBuffer</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ro">0:000> </span><span class="p">bp 0x00f650a6

</span><span class="ro">0:000> </span><span class="p">g
Breakpoint 0 hit
eax=0073ea08 ebx=00000880 ecx=09d33001 edx=00000000 esi=00c0b8fc edi=06832368
eip=00f650a6 esp=0073e9d8 ebp=0073ee0c iopl=0         nv up ei pl nz ac pe cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200217
notepad!UpdateEncoding+0x7e:
00f650a6 ff15c401f800    call    dword ptr ds:0023:00f801c4={KERNEL32!ReadFile (774ac5e0)}  

</span><span class="ro">0:000> </span><span class="p">dds esp L5
0073e9d8  00000880
0073e9dc  0073ea08
0073e9e0  00000400
0073e9e4  0073ea00
0073e9e8  00000000</span>
</code></pre></div></div><br>

<p class="plain-text">Después de ejecutar la función en la dirección <code class="language-plaintext highlighter-rouge">0x0073ea08</code> se deberia haber guardado el contenido del archivo, esto podemos comprobandolo usando <code class="language-plaintext highlighter-rouge">da</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ro">0:000> </span><span class="p">p
eax=00000001 ebx=00000880 ecx=09a0d9d1 edx=77931670 esi=00c0b8fc edi=06832368  
eip=00f650ac esp=0073e9ec ebp=0073ee0c iopl=0         nv up ei pl nz na pe nc  
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200206  
notepad!UpdateEncoding+0x84:
00f650ac 85c0            test    eax,eax

</span><span class="ro">0:000> </span><span class="p">da 0073ea08
0073ea08  "test"</span>
</code></pre></div></div><br>

</section>

</article>
  </div>
  <footer class="footer">
    <span class="footer__copyright">&copy; 2024 - xchg2pwn</span>
  </footer><br><br>

<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1678894953382991917"></script>

    </div>
  </body>
</html>
